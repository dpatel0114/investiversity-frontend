{"ast":null,"code":"// import PortfolioContainer from \"../containers/PortfolioContainer\";\n// import history from './history'\n// import {b} from 'react-router';\n// **import Popup from 'reactjs-popup';\n// let symbl;\n// const real_api = `https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=${symbl}&apikey=18BGJDXOZO2QLLIU`\n// const API = `https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=MSFT&apikey=demo`\nconst id = localStorage.uid; // const all_symbols = ['AAPL','MSFT','V',' GOOGL', 'AMZN']\n// const all_symbols = ['AAPL','MSFT','V','GOOGL', 'AMZN']\n\nconst all_symbols = ['MSFT']; // const NEW_API= `https://api.intrinio.com/prices/exchange?identifier=USCOMP&price_date=2019-07-25&api_key=OjZjM2IwOTIxMTEyMWVjZTQzNDVkM2Y5NmM0NjcyMTc2`\n\nconst NEW_API = \"https://api-v2.intrinio.com/stock_exchanges/USCOMP/prices?api_key=OjFlMjFhNTEzNGI1MWY1MzNiZGRjNjgyNjNjNjFiZmEx\"; // OjFlMjFhNTEzNGI1MWY1MzNiZGRjNjgyNjNjNjFiZmEx\n// OjZjM2IwOTIxMTEyMWVjZTQzNDVkM2Y5NmM0NjcyMTc2\n\nexport const getStocks = () => dispatch => {\n  all_symbols.map(symbl => // fetch(API)\n  // fetch(`https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=${symbl}&apikey=18BGJDXOZO2QLLIU`)\n  fetch(NEW_API).then(res => res.json()).then(data => dispatch({\n    type: \"GET_STOCKS\",\n    data: data.stock_prices\n  })));\n};\nexport const handleChange = e => dispatch => {\n  e.target.name === 'username' ? dispatch({\n    type: 'CHANGE_USER',\n    'username': e.target.value\n  }) : dispatch({\n    type: 'CHANGE_PASS',\n    'password': e.target.value\n  });\n};\nexport const getPortfolio = e => dispatch => {\n  // e.preventDefault()\n  fetch(\"https://investiversity-backend.herokuapp.com/portfolio/show_all?user_id=\".concat(id)).then(res => res.json()).then(data => {\n    // console.log(data)\n    dispatch({\n      type: \"PORT_HISTORY\",\n      data: data.portfolio\n    });\n  });\n}; // export const getUserWithId =()=> dispatch => {\n//   fetch(`https://investiversity-backend.herokuapp.com/users/${id}`)\n//   .then(res => res.json())\n//   .then(data => { \n//     console.log('user', data)\n//     localStorage.setItem('portfolio', JSON.stringify(data.portfolio))\n//     dispatch({ type: 'GET_PORTFOLIO',portfolio: data.portfolio })\n//   })\n// }\n\nexport const handleSignUp = e => dispatch => {\n  e.preventDefault();\n  let newUserObject = {\n    firstname: e.target.firstname.value,\n    lastname: e.target.lastname.value,\n    username: e.target.username.value,\n    password: e.target.password.value,\n    email: e.target.email.value\n  };\n  fetch('https://investiversity-backend.herokuapp.com/users', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'Accept': 'application/json'\n    },\n    body: JSON.stringify({\n      user: newUserObject\n    })\n  }).then(res => res.json()).then(data => {\n    if (data.errors) {\n      alert(\"Sorry, your username or password is incorrect.\");\n      dispatch({\n        type: 'SIGNUP_ERROR',\n        errors: data.message\n      });\n    } else {\n      localStorage.setItem('token', data.token); // browserHistory.push('/login')\n      // this.props.history.push('/login')\n      // history.push('/login')\n    }\n  });\n};\nexport const searchStock = e => dispatch => {\n  e.preventDefault(); // console.log(e.target)\n\n  fetch(\"https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=BA&apikey=demo\").then(res => res.json()).then(data => dispatch({\n    type: 'SEARCH_STOCK',\n    payload: data[\"bestMatches\"]\n  }));\n};\nexport const handleLogin = (e, user, history) => dispatch => {\n  e.preventDefault();\n  fetch('https://investiversity-backend.herokuapp.com/login', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(user)\n  }).then(res => res.json()).then(data => {\n    if (data.errors) {\n      dispatch({\n        type: 'LOGIN_ERROR',\n        error: data.errors\n      });\n      localStorage.setItem('logged', false);\n      alert('Incorrect Username or Password! ');\n    } else {\n      history.push('/dashboard');\n      localStorage.setItem('logged', true);\n      localStorage.setItem('token', data.token);\n      localStorage.setItem('uid', data.user.id);\n      localStorage.setItem('firstname', data.user.firstname);\n      localStorage.setItem('portfolio', JSON.stringify(data.user.portfolios));\n      localStorage.setItem('reamining_balance', data.user.remaining_balance);\n      localStorage.setItem('invested_balance', data.user.invested_balance);\n      dispatch({\n        type: 'LOGIN_SUCCESS',\n        user: data.user,\n        logged: true,\n        portfolio: data.user.portfolios\n      });\n    }\n  });\n}; //   STOCK\n\nexport const buyStock = (e, eachStock, balance) => dispatch => {\n  e.preventDefault(); // console.log(e.target)\n\n  let stock = {\n    price: parseFloat(eachStock['close']),\n    ticker: eachStock.security['ticker'],\n    quantity: parseFloat(e.target.quantity.value),\n    total_price: parseFloat(eachStock['close'] * e.target.quantity.value),\n    user_id: parseFloat(localStorage.uid)\n  };\n\n  if (balance.remaining_balance < stock.total_price) {\n    alert('Not Enough Balance');\n    return;\n  }\n\n  let user = {\n    remaining_balance: balance.remaining_balance - stock.total_price,\n    invested_balance: balance.invested_balance + stock.total_price\n  };\n  fetch(\"https://investiversity-backend.herokuapp.com/portfolios\", {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"Accept\": \"application/json\"\n    },\n    body: JSON.stringify({\n      portfolio: stock\n    })\n  });\n  fetch(\"https://investiversity-backend.herokuapp.com/users/\".concat(id), {\n    method: \"PATCH\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"Accept\": \"application/json\",\n      \"Access-Token\": localStorage.getItem('token')\n    },\n    body: JSON.stringify({\n      user: user\n    })\n  }).then(res => res.json().then(data => console.log(data)));\n  dispatch({\n    type: 'BUY_STOCK',\n    payload: stock\n  });\n  e.target.reset();\n}; // Persist portfolio and balance\n// export const persistData =()=> dispatch=>{\n//   console.log('running')\n//   fetch(`https://investiversity-backend.herokuapp.com/users/${id}`)\n//   .then(res => res.json())\n//   .then(data=> \n//     {console.log(data)\n//   dispatch({type:'LOGIN_SUCCESS', user: data.user, logged: true, portfolio: data.user.portfolios})}\n//   )\n// }\n// logout\n\nexport const handleLogout = (e, history) => dispatch => {\n  // console.log(e.target)\n  e.preventDefault();\n  localStorage.clear(); // console.log(history.push)\n\n  dispatch({\n    type: 'LOGOUT',\n    logged: false\n  });\n  history.push('/');\n};\nexport const sellStock = (e, eachStock, balance) => dispatch => {\n  e.preventDefault(); // console.log(e.target)\n\n  let stock = {\n    price: parseFloat(eachStock.price),\n    ticker: eachStock.ticker,\n    quantity: -parseInt(e.target.quantity.value),\n    total_price: -parseFloat(eachStock.price * e.target.quantity.value),\n    user_id: parseInt(localStorage.uid)\n  };\n  let user = {\n    remaining_balance: balance.remaining_balance - stock.total_price,\n    invested_balance: balance.invested_balance + stock.total_price\n  };\n  fetch(\"https://investiversity-backend.herokuapp.com/portfolios\", {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"Accept\": \"application/json\"\n    },\n    body: JSON.stringify({\n      portfolio: stock\n    })\n  });\n  fetch(\"https://investiversity-backend.herokuapp.com/users/\".concat(id), {\n    method: \"PATCH\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"Accept\": \"application/json\",\n      \"Access-Token\": localStorage.getItem('token')\n    },\n    body: JSON.stringify({\n      user: user\n    })\n  }).then(res => res.json().then(data => console.log(data)));\n  dispatch({\n    type: 'SELL_STOCK',\n    payload: stock\n  });\n  e.target.reset();\n};","map":{"version":3,"sources":["/Users/Krunal/flatiron_school/module-5-folder/investiversity-frontend/src/actions/stockActions.js"],"names":["id","localStorage","uid","all_symbols","NEW_API","getStocks","dispatch","map","symbl","fetch","then","res","json","data","type","stock_prices","handleChange","e","target","name","value","getPortfolio","portfolio","handleSignUp","preventDefault","newUserObject","firstname","lastname","username","password","email","method","headers","body","JSON","stringify","user","errors","alert","message","setItem","token","searchStock","payload","handleLogin","history","error","push","portfolios","remaining_balance","invested_balance","logged","buyStock","eachStock","balance","stock","price","parseFloat","ticker","security","quantity","total_price","user_id","getItem","console","log","reset","handleLogout","clear","sellStock","parseInt"],"mappings":"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","sourcesContent":["// import PortfolioContainer from \"../containers/PortfolioContainer\";\n\n// import history from './history'\n// import {b} from 'react-router';\n// **import Popup from 'reactjs-popup';\n// let symbl;\n// const real_api = `https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=${symbl}&apikey=18BGJDXOZO2QLLIU`\n// const API = `https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=MSFT&apikey=demo`\nconst id = localStorage.uid\n// const all_symbols = ['AAPL','MSFT','V',' GOOGL', 'AMZN']\n// const all_symbols = ['AAPL','MSFT','V','GOOGL', 'AMZN']\nconst all_symbols = ['MSFT']\n// const NEW_API= `https://api.intrinio.com/prices/exchange?identifier=USCOMP&price_date=2019-07-25&api_key=OjZjM2IwOTIxMTEyMWVjZTQzNDVkM2Y5NmM0NjcyMTc2`\nconst NEW_API= `https://api-v2.intrinio.com/stock_exchanges/USCOMP/prices?api_key=OjFlMjFhNTEzNGI1MWY1MzNiZGRjNjgyNjNjNjFiZmEx`\n\n// OjFlMjFhNTEzNGI1MWY1MzNiZGRjNjgyNjNjNjFiZmEx\n\n// OjZjM2IwOTIxMTEyMWVjZTQzNDVkM2Y5NmM0NjcyMTc2\n\n\n\n\nexport const getStocks = () => dispatch => {\n    \n   all_symbols.map(symbl => \n    // fetch(API)\n    // fetch(`https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=${symbl}&apikey=18BGJDXOZO2QLLIU`)\n    fetch(NEW_API)\n    .then(res => res.json())\n    .then(data => \n      dispatch({ type: \"GET_STOCKS\", data: data.stock_prices })\n      )\n    )\n}\n\n\n\nexport const handleChange = (e) => dispatch=>{\n\n  e.target.name ==='username'?\n  dispatch(\n    { type: 'CHANGE_USER', 'username': e.target.value}\n  ) \n  : \n  dispatch(\n      { type: 'CHANGE_PASS', 'password': e.target.value}\n    ) \n  \n}\n\n\nexport const getPortfolio =(e)=> dispatch => {\n  // e.preventDefault()\n  fetch(`https://investiversity-backend.herokuapp.com/portfolio/show_all?user_id=${id}`)\n    .then(res => res.json())\n    .then(data => {\n      // console.log(data)\n      dispatch({ type: \"PORT_HISTORY\", data: data.portfolio })\n    })\n}\n\n\n// export const getUserWithId =()=> dispatch => {\n//   fetch(`https://investiversity-backend.herokuapp.com/users/${id}`)\n//   .then(res => res.json())\n//   .then(data => { \n//     console.log('user', data)\n//     localStorage.setItem('portfolio', JSON.stringify(data.portfolio))\n//     dispatch({ type: 'GET_PORTFOLIO',portfolio: data.portfolio })\n//   })\n// }\n\n\nexport const handleSignUp=(e)=> dispatch => {\n    \n  e.preventDefault()\n\n  let newUserObject ={\n    firstname: e.target.firstname.value,\n    lastname: e.target.lastname.value,\n    username: e.target.username.value,\n    password: e.target.password.value,\n    email: e.target.email.value\n  }\n \n  fetch('https://investiversity-backend.herokuapp.com/users',{\n    method:'POST',\n    headers:{\n      'Content-Type': 'application/json',\n      'Accept': 'application/json'\n  },\n    body:JSON.stringify({ user: newUserObject})\n    })\n    .then(res=> res.json())\n    .then(data => {\n\n      if (data.errors) {\n        alert(\"Sorry, your username or password is incorrect.\")\n        dispatch({ type: 'SIGNUP_ERROR',errors: data.message })\n      }\n      else {\n\n        localStorage.setItem('token', data.token)\n        // browserHistory.push('/login')\n        // this.props.history.push('/login')\n       \n        // history.push('/login')\n      }\n    })\n}\n\n export const searchStock =(e) => dispatch => {\n  e.preventDefault()\n  // console.log(e.target)\n  fetch(\"https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=BA&apikey=demo\")\n  .then(res => res.json())\n  .then(data => dispatch({\n    type: 'SEARCH_STOCK',\n    payload: data[\"bestMatches\"]\n  }))\n }\n\n export const  handleLogin =(e, user,history) => dispatch=> {\n  e.preventDefault()\n\n  fetch('https://investiversity-backend.herokuapp.com/login', {\n    method: 'POST',\n    headers:{\n      'Content-Type': 'application/json', \n    }, \n    body: JSON.stringify(user)\n  })\n  .then(res => res.json())\n  .then(data => { \n\n    if(data.errors){\n      dispatch({type: 'LOGIN_ERROR', error: data.errors})\n      localStorage.setItem('logged',false)\n      alert('Incorrect Username or Password! ')\n    }\n    else {\n\n      history.push('/dashboard')\n      localStorage.setItem('logged',true)\n      localStorage.setItem('token', data.token)\n      localStorage.setItem('uid', data.user.id)\n      localStorage.setItem('firstname', data.user.firstname)\n      localStorage.setItem('portfolio',JSON.stringify(data.user.portfolios))\n      localStorage.setItem('reamining_balance', data.user.remaining_balance)\n      localStorage.setItem('invested_balance', data.user.invested_balance)\n      \n      dispatch({type:'LOGIN_SUCCESS', user: data.user, logged: true, portfolio: data.user.portfolios})\n    }\n  })\n\n}\n\n\n//   STOCK\nexport const buyStock = (e, eachStock, balance)=> dispatch=> {\n  e.preventDefault()\n  // console.log(e.target)\n  \n  let stock ={\n\n    price: parseFloat(eachStock['close']),\n    ticker: eachStock.security['ticker'],\n    quantity: parseFloat(e.target.quantity.value),\n    total_price: parseFloat(eachStock['close'] * e.target.quantity.value),\n    user_id: parseFloat(localStorage.uid)\n\n  }\n\n  if(balance.remaining_balance < stock.total_price){\n    alert('Not Enough Balance')\n    return \n  }\n\n  let user ={\n    remaining_balance: balance.remaining_balance - stock.total_price,\n    invested_balance: balance.invested_balance + stock.total_price\n  }\n  \n  fetch(`https://investiversity-backend.herokuapp.com/portfolios`,{\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"Accept\": \"application/json\"\n    },\n      body: JSON.stringify({portfolio: stock})\n    })\n  \n    fetch(`https://investiversity-backend.herokuapp.com/users/${id}`,{\n      method: \"PATCH\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Accept\": \"application/json\",\n        \"Access-Token\":localStorage.getItem('token')\n      },\n        body: JSON.stringify({user: user})\n      })\n      .then(res=> res.json()\n    .then(data=> console.log(data)))\n    \n\n\n  dispatch({type: 'BUY_STOCK', payload: stock})\n  e.target.reset()\n\n  }\n\n\n// Persist portfolio and balance\n// export const persistData =()=> dispatch=>{\n//   console.log('running')\n\n//   fetch(`https://investiversity-backend.herokuapp.com/users/${id}`)\n//   .then(res => res.json())\n//   .then(data=> \n//     {console.log(data)\n//   dispatch({type:'LOGIN_SUCCESS', user: data.user, logged: true, portfolio: data.user.portfolios})}\n\n//   )\n// }\n\n// logout\nexport const handleLogout=(e, history)=> dispatch=>{\n  // console.log(e.target)\n  e.preventDefault()\n  localStorage.clear()\n  // console.log(history.push)\n   dispatch({\n    type: 'LOGOUT',\n    logged: false\n  })\n  history.push('/')\n\n}\n\n\nexport const  sellStock = (e, eachStock,balance)=> dispatch=> {\n  e.preventDefault()\n  // console.log(e.target)\n  let stock ={\n    price: parseFloat(eachStock.price),\n    ticker: eachStock.ticker,\n    quantity: -parseInt(e.target.quantity.value),\n    total_price: -parseFloat(eachStock.price * e.target.quantity.value),\n    user_id: parseInt(localStorage.uid)\n\n  }\n  \n  let user ={\n    remaining_balance: balance.remaining_balance - stock.total_price,\n    invested_balance: balance.invested_balance + stock.total_price\n  }\n  \n  fetch(`https://investiversity-backend.herokuapp.com/portfolios`,{\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"Accept\": \"application/json\"\n    },\n      body: JSON.stringify({portfolio: stock})\n    })\n\n    fetch(`https://investiversity-backend.herokuapp.com/users/${id}`,{\n      method: \"PATCH\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Accept\": \"application/json\",\n        \"Access-Token\":localStorage.getItem('token')\n      },\n        body: JSON.stringify({user: user})\n      })\n      .then(res=> res.json()\n    .then(data=> console.log(data)))\n\n\n  dispatch({type: 'SELL_STOCK', payload: stock})\n  e.target.reset()\n\n  }"]},"metadata":{},"sourceType":"module"}